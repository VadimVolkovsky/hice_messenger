# hice_messenger


### Описание:
Мессенджер для "Хайс Банк"


### Инструкция по запуску:
**Клонируйте репозиторий:**
```
git@github.com:VadimVolkovsky/hice_messenger.git
```

**В корневой директории проекта создайте файл .env и заполните его по образцу ниже:**
```
APP_TITLE=hice messenger
APP_DESCRIPTION=Мессенджер для банка
SECRET = supersecret
DATABASE_URL=postgresql+asyncpg://postgres:postgres@db:5432/hice_database
DB_PORT=5432
DB_NAME=hice_database
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=hice_database
```

**Из корневой директории проекта выполните запуск контейнеров:**
```
docker-compose up --build
```

Будет выполнено разворачивание 4 контейнеров:

- hice_db - База данных
- hice_backend_1 - Сервер №1
- hice_backend_2 - Сервер №2
- hice_client - Клиент

После успешного разворачивания первых 3 контейнеров, в базе данных будут автоматически созданы необходимые таблицы и применены миграции.

После разворачивания контейнера клиента (hice_client), будут выполнено по 100 запросов от 50 одновременно запущенных корутин на указанный список серверов (среднее время выполнения 1 минута)

По итогу выполнения запросов, в консоль и в файл логов (logs/client_app.log) будет выведен отчет, в формате:
```
hice_client     | "05.06.2023 11:19:38 - [INFO] - Сумарное количество запросов: 5000 шт."
hice_client     | "05.06.2023 11:19:38 - [INFO] - Среднее время выполнения запроса: 0.90626 сек."
hice_client     | "05.06.2023 11:19:38 - [INFO] - Пропускная способность серверов: 5517 RPS"
hice_client     | "05.06.2023 11:19:38 - [INFO] - Итоговое время выполнения всех запросов: 0:01:07.872621 сек."
hice_client     | "05.06.2023 11:19:38 - [INFO] - Завершение работы генератора запросов"
```


**Конфигурация клиента:**

Основные настройки клиента прописаны в файле client_app/config.py

Количество клиентов (корутин):
```
COROUTINE_AMOUNT = 50
```

Количество запросов на каждого клиента
```
REQUESTS_AMOUNT = 100
```

Доступные адреса для запросов:
```
URLS = [
    'http://backend_1:80/message/',
    'http://backend_2:81/message/'
]
```

### Логирование:
В приложении и в клиенте реализовано логирование.

Логи приложения (сервера) сохраняются здесь:
```
app/logs/
```

Логи клиента выводятся в консоль и сохраняются здесь:
```
client_app/logs/
```


### Документация приложения:
- Swagger
```
http://127.0.0.1:80/docs
```

- Redoc
```
http://127.0.0.1:80/redoc
```



### Технологии:
- Python 3.9
- FastAPI
- SQLAlchemy
- Alembic
- asyncio
- PostgreSQL


**Автор проекта:**

Vadim Volkovsky
